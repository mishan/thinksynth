# $Id: Makefile.in,v 1.53 2004/10/01 08:52:26 misha Exp $

BINARY = thinksynth

bindir=@bindir@
prefix=@prefix@

all: thinksynth

soname = @lib_revision@

include ../build.mk

PICFLAGS =
LDFLAGS += @LIBS@ @GTKMM_LIBS@ @GTHREAD_LIBS@ -L../libthink -lthink @JACK_LIBS@ @ALSA_LIBS@
INCLUDES = -I.. -I../libthink @GTKMM_CFLAGS@ @JACK_CFLAGS@ @ALSA_CFLAGS@
WIDGETSRCS = gui/AboutBox.cpp gui/ArgTable.cpp gui/MainSynthWindow.cpp gui/PatchSelWindow.cpp gui/Keyboard.cpp gui/KeyboardWindow.cpp
MAINOBJS = main.o @GTH_ALSA@ @GTH_JACK_AUDIO@ gthPrefs.o gthPatchfile.o

thinksynth: ../libthink/libthink.so.$(soname) gui/gth.a $(MAINOBJS)
	$(CXX) $(CXXFLAGS) -o $@ $(MAINOBJS) $(LDFLAGS) gui/gth.a

gui/gth.a: $(WIDGETSRCS)
	$(MAKE) -C gui gth.a

../libthink/libthink.so.$(soname):
# XXX
ifeq (,$(wildcard ../libthink/.bstamp))
	$(MAKE) -C ../libthink
endif

clean::
	rm -f thinksynth
	$(MAKE) -C gui $@

distclean::
	rm -f Makefile
	$(MAKE) -C gui $@

install:
	mkdir -p $(DESTDIR)$(bindir)
	cp -f thinksynth $(DESTDIR)$(bindir)

uninstall:
	rm -f $(DESTDIR)$(bindir)/thinksynth
